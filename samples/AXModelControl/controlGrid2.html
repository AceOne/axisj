<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>AXModelControl</title>
    
    <meta property="og:image" content="/img/axisj_sns.png" /> 
    <meta property="og:site_name" content="Axis of Javascript - axisj.com" /> 
    <meta property="og:description" id="meta_description" content="Javascript UI Library based on JQuery" />

	<!-- css block -->
	<link rel="stylesheet" type="text/css" href="../../css/default_common.css" />
	<link rel="stylesheet" type="text/css" href="../../_AXJ/ui/default/AXJ.css" />
	<link rel="stylesheet" type="text/css" href="../../_AXJ/ui/default/AXInput.css" />
	<link rel="stylesheet" type="text/css" href="../../_AXJ/ui/default/AXTabs.css" />
	<link rel="stylesheet" type="text/css" href="../../_AXJ/ui/default/AXModelControlGrid.css" />
	<style type="text/css">
	H2{font-family:consolas;}
	
	/* AXInputGroup */
	.AXInputGroup{
		border:1px solid #b6b6b6;background:#fff;
		box-shadow:inset 0px 1px 2px #dddddd;
		border-radius:4px;
		padding:0px 4px;
	}
	.AXInputGroup.inlineBlock{
		display:inline-block;position:relative;
		border:1px solid #b6b6b6;background:#fff;
		box-shadow:inset 0px 1px 2px #dddddd;
		border-radius:4px;
		padding:0px 4px;
	}
	.AXInputGroup input[type=text]{
		border:0px none;padding:0px;
		width:100%;
		padding:4px 0px;
		font-size:12px;line-height:15px;height:15px;
		background:none;
	}
	
	/* AXInputGroupSmall */
	.AXInputGroupSmall{
		border:1px solid #b6b6b6;background:#fff;
		box-shadow:inset 0px 1px 2px #dddddd;
		border-radius:4px;
		padding:0px 3px;
	}
	.AXInputGroupSmall.inlineBlock{
		display:inline-block;position:relative;
		border:1px solid #b6b6b6;background:#fff;
		box-shadow:inset 0px 1px 2px #dddddd;
		border-radius:4px;
		padding:0px 3px;
	}
	.AXInputGroupSmall input[type=text]{
		border:0px none;padding:0px;
		width:100%;
		padding:0px 0px;
		font-size:11px;line-height:12px;height:12px;
		background:none;
	}
	
	.w70{width:70px;}
	.w80{width:80px;}
	.w90{width:90px;}
	.w20{width:20px;}
	</style>
	<!-- css block -->

	<!-- js block -->
	<script type="text/javascript" src="../../_AXJ/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="../../_AXJ/lib/AXJ.js"></script>
	<script type="text/javascript" src="../../_AXJ/lib/AXInput.js"></script>
	<script type="text/javascript" src="../../_AXJ/lib/AXModelControl.js"></script>
	<script type="text/javascript" src="../../_AXJ/lib/AXModelControlGrid.js"></script>
	<script type="text/javascript" src="../../_AXJ/lib/AXCodeView.js"></script>

	<script type="text/javascript">
	//var myModel = new AXModelControl();
	var myModelGrid = new AXModelControlGrid();
	
	var fnObj = {
		pageStart: function(){

			myModelGrid.setConfig({
				theme:"AXModelControlGrid",
				targetID:"AXModelControlListTarget",
					colGroup:[
						{label:"No", width:"40", align:"center",
							html:function(){
								return '<button class="AXButtonSmall Red" onclick="fnObj.del();">Del</button>';
						}},
						{label:"Name", width:"175", align:"center"},
						{label:"Date", width:"250", align:"center"},
						{label:"Adult/Child", width:"85", align:"center"},
						{label:"RoomType", width:"90", align:"center"},
						{label:"RoomPrice", width:"90", align:"center"},
						{label:"R/C", width:"40", align:"center"},
						{label:"S/M", width:"40", align:"center"},
						{label:"E/B", width:"40", align:"center"},
						{label:"B/F", width:"65", align:"center"},
						{label:"Notice", width:"160", align:"center", classnm:"last"}
					],
					body:{
						form:[
							{ // No
								id:"",
								align:"center",
								data:{},
								html:function(){
									var po = [];
									po.push('<input type="checkbox" name="sno" value="'+this.rowIndex+'" />');
									po.push('<input type="hidden" name="email" value="'+(this.item.email || "")+'" />');
									po.push('<input type="hidden" name="tel" value="'+(this.item.tel || "")+'" />');
									po.push('<input type="hidden" name="lng_cd" value="'+(this.item.lng_cd || "")+'" />');
									po.push('<input type="hidden" name="nation_cd" value="'+(this.item.nation_cd || "")+'" />');
									return po.join('');
								}
							},
							{ // Name
								id:"",
								data:{},
								html:function(){
									var po = [];
									po.push('<div class="wrapInput">');
									po.push('	<input type="text" name="chkman_nm" id="chkman_nm_' + this.rowIndex + '" class="AXInputSmall" value="'+(this.item.chkman_nm || "")+'" />');
									po.push('</div>');
									return po.join('');
								}
							},
							{ // Date
								id:"",
								data:{},
								html:function(){
									var po = [];
									
									po.push('<div class="tdRel tac">');
									po.push('<input type="text" name="arr_date" id="arr_date_' + this.rowIndex + '" maxlength="10" class="AXInputSmall v-req w70" title="Check In" value="'+(this.item.arr_date || "")+'" /> ~');
									po.push('<div class="rel inlineBlock">');
									po.push('<input type="text" name="dep_date" id="dep_date_' + this.rowIndex + '" maxlength="10" class="AXInputSmall v-req w90" title="Check Out" value="'+(this.item.dep_date || "")+'" />');
									po.push('</div>');
									po.push('&nbsp;<input type="text" name="night_cnt" id="night_cnt_' + this.rowIndex + '" placeholder="D" maxlength="30" class="AXInputSmall v-req w20" title="Night" value="'+(this.item.night_cnt || "")+'" />');
									po.push('</div>');
									
									return po.join('');
								},
								AXBind: {
									id:"dep_date_@rowIndex",
									type:"TwinDate",
									config:{
										align:"right", valign:"bottom", startTargetID:"arr_date_@rowIndex"
									},
									onchange: function(){
										var count = this.ST_value.date().diff(this.ED_value).number() + 1;
										reservationModelGrid.updateItem(this.rowIndex, {arr_date:this.ST_value, dep_date:this.ED_value, night_cnt:count});
										fnObj.reservationlist.changedata(this.rowIndex);		
									}
								}								
							},
							{ // Adult/Child
								id:"",
								align:"center",
								data:{},
								html:function(){
									var po = [];
										
									po.push('<input type="text" name="adlt_cnt" id="adlt_cnt_' + this.rowIndex + '" placeholder="A" maxlength="3" class="AXInputSmall w20 numtype" value="'+(this.item.adlt_cnt || "")+'" /> / ');
									po.push('<input type="text" name="chld_cnt" id="chld_cnt_' + this.rowIndex + '" placeholder="C" maxlength="3" class="AXInputSmall w20 numtype" value="'+(this.item.chld_cnt || "")+'" />');
										
									return po.join('');
								}
							},
							{ // 룸타입
								id:"roomType",
								align:"center",
								data:{},
								html:function(){
									var po = [];

									var room_typ_cd_val = this.item.room_typ_cd;

									po.push('<select name="room_typ_cd" id="room_typ_cd_' + this.rowIndex + '" class="AXSelectSmall v-req" title="Room Type" style="width:100%" onchange="fnObj.reservationlist.changedata(' + this.rowIndex + ');">');
			                        po.push('<option value=""></option>');
									/*
									$.each(room_typ_cd, function(k, v){
										if ((room_typ_cd_val || "") == this.optionValue)
											po.push('<option value="' + this.optionValue + '" selected>' + this.optionText + '</option>');
										else
											po.push('<option value="' + this.optionValue + '">' + this.optionText + '</option>');

									});
*/
									po.push('</select>');
	
									return po.join('');
								}
							},
							{ // 룸가격
								id:"roomPrice",
								align:"center",
								data:{},
								html:function(){
									return '<span id="lbl_room_prc_' + this.rowIndex + '"><a href="#" onclick="fnObj.dtlsForm.openRoomPrice(' + this.rowIndex + ');">' + (this.item.room_prc || "").number().money() + '</a></span>';
								}
							},
							{ // R/C
								data:{},
								html:function(){
									var po = [];
									po.push('<input type="text" name="room_cnt" id="room_cnt_' + this.rowIndex + '" maxlength="3" class="AXInputSmall w20 numtype" value="'+(this.item.room_cnt || "")+'" />');
									return po.join('');
								}
							},
							{ // Smoking
								align:"center",
								data:{},
								html:function(){
									var po = [];
									po.push('<input type="checkbox" name="smk_yn" id="smk_yn_' + this.rowIndex + '" value="Y" ');

									if ((this.item.smk_yn || "")=="Y")
										po.push('checked />');
										
									else
										po.push('/>');

									return po.join('');
								}
							},
							{ // EXT.BED
								id:"EXT.BED",
								align:"right",
								data:{},
								html:function(){
									var po = [];
									po.push('<div class="wrapInput">');
									po.push('<input type="text" name="eb_cnt" id="eb_cnt_' + this.rowIndex + '" maxlength="3" class="AXInputSmall w20 numtype" value="'+(this.item.eb_cnt || "")+'" />');
									po.push('</div">');
									return po.join('');
								}
							},
							{ // B/F
								id:"BF",
								align:"right",
								data:{},
								html:function(){
									return '<span id="lbl_bfast_prc_' + this.rowIndex + '">' + (this.item.bfast_prc || "").number().money() + '</span>';
								}
							},
							{ // NOTICE
								id:"Notice",
								data:{},
								classnm:"last",
								html:function(){
									var po = [];
									po.push('<div class="wrapInput">');
									po.push('	<input type="text" name="contents" id="contents_' + this.rowIndex + '" class="AXInputSmall" value="'+(this.item.contents || "")+'" />');
									po.push('</div>');
									return po.join('');
								}
							}
						]
					}
			});
			
			myModelGrid.setList([]);

			//-----------------------
			AXCode.bind(); // 소스보기
		},
		add: function(){
			var item = {
				room_typ_cd:[]
			};
			myModelGrid.appendList(item);
		},
		del: function(){
			var objs = myModelGrid.getCheckedValue("sno");
			// input name="rowIndex" 의 값을 가져옵니다.
			
			myModelGrid.removeItem(objs);
			
			//myModelGrid.removeItem([]);
			//myModelGrid.removeItem(Number)
		},
		output: function(){
			var list = myModelGrid.getList();
			trace(list);
		},
		changedata: function(rowIndex){
			//alert(rowIndex);	
			(function(){
				trace(myModelGrid.list[rowIndex]);
				myModelGrid.updateItem(rowIndex, {xxx:"qwe"});
			}).delay(0.01);
			
		}
	};
	$(document.body).ready(function(){
		fnObj.pageStart.delay(0.01);
	});
	</script>
	<!-- js block -->

</head>
<body>
	<div style="padding:20px;">
		
		<div class="AXTabs">
			<div class="AXTabsTray">
				<a href="index.html" class="AXTab Blue">Default</a>
				<a href="controlGrid.html" class="AXTab Blue on">controlGrid</a>
				<div class="clear"></div>
			</div>
		</div>
		
		<div class="Hspace20"></div>

		<div style="padding:10px;">
			<button class="AXButton" onclick="fnObj.add();">add</button>
		</div>
		
		<div id="AXModelControlListTarget"></div>

		<div style="padding:10px;">
			<button class="AXButton" onclick="fnObj.output();">데이터추출</button>
		</div>
		
	</div>
</body>
</html>
